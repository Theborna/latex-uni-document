\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{lipsum}
\usepackage[a4paper ,margin=1in, headheight=16pt]{geometry}
\usepackage{tikz}
\usepackage{lastpage}
\usepackage[most]{tcolorbox}
\usetikzlibrary{calc}
%\usetikzlibrary{patterns}
% \usepackage[
%   automark,
%   autooneside=false,% <- needed if you want to use \leftmark and \rightmark in a onesided document
%   headsepline,
%   footsepline
% ]{scrlayer-scrpage}
\usepackage{fancyhdr}
\usepackage{calc}
\newcommand{\sigline}[1]{\makebox[\widthof{#1~}]{.\dotfill}}
% to support english documents
\ProvidesPackage{style}[2014/01/05 ...]
\newif\if@mylang\@mylangfalse
\newif\if@myborder\@myborderfalse
\DeclareOption{en}{\@mylangtrue}
\DeclareOption{bordered}{\@mybordertrue}
\DeclareOption*{\OptionNotUsed}
\ProcessOptions\relax
\if@mylang
  \newcommand{\initStyle}{
    \newcommand{\mytitle}{\sigline{title of document}}
    \newcommand{\myauthor}{\sigline{name of professor}}
    \newcommand{\department}{department: \sigline{department}}
    \newcommand{\subject}{\sigline{subject of document}}
    \newcommand{\info}{author: \sigline{author name}}
    \newcommand{\subtitle}{\,}
    \renewcommand{\date}{date: \sigline{1400/00/00}}
  }
  \newcommand{\defsolvetitle}{Soloution}
\else
  \newcommand{\initStyle}{
    \newcommand{\mytitle}{\sigline{موضوع فایل}}
    \newcommand{\myauthor}{\sigline{نام استاد}}
    \newcommand{\department}{دانشکده: \sigline{نام دانشکده}}
    \newcommand{\subject}{\sigline{موضوع برگه عنوان}}
    \newcommand{\info}{نویسنده: \sigline{نام نویسنده}}
    \newcommand{\subtitle}{\,}
    \renewcommand{\date}{تاریخ: \sigline{1400/00/00}}
  }
  \newcommand{\defsolvetitle}{پاسخ}
\fi

\newcommand{\setTitle}[1]{\renewcommand{\mytitle}{#1}}
\newcommand{\setProf}[1]{\renewcommand{\myauthor}{#1}}
\newcommand{\setDepartment}[1]{\renewcommand{\department}{#1}}
\newcommand{\setSubject}[1]{\renewcommand{\subject}{#1}}
\newcommand{\setInfo}[1]{\renewcommand{\info}{#1}}
\newcommand{\setSubtitle}[1]{\renewcommand{\subtitle}{#1}}
\newcommand{\setDate}[1]{\renewcommand{\date}{#1}}

\newcommand{\myborder}{}
\if@myborder
  \renewcommand{\myborder}{%
    \begin{tikzpicture}[remember picture,overlay]
      \definecolor{sharif}{HTML}{07357A}
      \clip (current page.north west) rectangle ($(current page.north east)+(0,-0.7)$);
      %     \foreach \x in {-9,-6.3,...,27}{
      %         \draw[red, line width=0.6cm, rotate=-45] (\x,-\paperheight) -- ++(0,2*\paperheight);
      %         \draw[blue!30!lightgray,line width=0.6cm, rotate=-45] (\x+1.35,-\paperheight) -- ++(0,2*\paperheight);
      %       }
            \foreach \x in {-9,-6.3,...,27}{
              \draw[sharif, line width=0.6cm, rotate=-45] (\x,-\paperheight) -- ++(0,2*\paperheight);
              \draw[blue!30!lightgray,line width=0.6cm, rotate=-45] (\x+1.35,-\paperheight) -- ++(0,2*\paperheight);
            }
      % \foreach \x in {-10,-7.3,...,26}{
      %     \draw[blue, line width=1.4cm] (\x,-\paperheight) -- ++(0,2*\paperheight);
      %     \draw[blue, line width=2cm] (\x+1.35,-\paperheight) -- ++(0,1.09*\paperheight);
      %     \draw[white, line width=0.8cm] (\x,-\paperheight) -- ++(0,1.09*\paperheight);
      %   }
    \end{tikzpicture}

  }

\fi

\newcommand{\conclusion}[1]{
  % \vspace*{1em}\\
  \rule{\textwidth}{0.5pt}
  \begin{abstract}
    \centering
    #1
  \end{abstract}
  \rule{\textwidth}{0.5pt}
}

\newcommand{\qsolve}[2][\defsolvetitle]{\begin{tcolorbox}[title=#1]#2\end{tcolorbox}}

\rhead{\mytitle}
\lhead{\subject}
\cfoot{\thepage/\pageref{LastPage}}
\renewcommand{\footrulewidth}{1pt}
\pagestyle{fancy}
\initStyle